# 1. 汇编相关

- [1. 汇编相关](#1-汇编相关)
  - [1.1. 启动文件](#11-启动文件)
    - [1.1.1. 复位向量和中断向量的设置](#111-复位向量和中断向量的设置)
    - [1.1.2. 初始化数据段和BSS段](#112-初始化数据段和bss段)
    - [1.1.3. 设置堆和栈](#113-设置堆和栈)
    - [1.1.4. 初始化硬件](#114-初始化硬件)
    - [1.1.5. 跳转到主程序](#115-跳转到主程序)
    - [1.1.6. 附加功能](#116-附加功能)

## 1.1. 启动文件
在嵌入式系统中，启动文件（通常也叫启动代码、启动程序或启动例程）有着非常重要的作用。这些文件通常是汇编语言或低级C语言编写的，它们作为整个嵌入式软件的入口点，并负责初始化硬件以及准备软件环境，以便主程序（通常是一个C语言的 `main()` 函数）能正常运行。

下面列举了启动文件通常需要完成的一些任务：

### 1.1.1. 复位向量和中断向量的设置
启动文件通常包含一个向量表，该表定义了各种中断和异常的处理程序入口点。最重要的通常是复位向量，它指向系统复位后应执行的第一条指令。

### 1.1.2. 初始化数据段和BSS段
全局和静态变量可能需要在RAM中进行初始化。对于初值不为零的变量，启动代码会把这些变量的初值从Flash或其他非易失存储器复制到RAM中。对于初值为零或未初始化的变量（通常位于BSS段），启动代码通常会将这些变量的内存区域清零。

### 1.1.3. 设置堆和栈
启动文件通常负责设置栈指针，以及在需要的情况下初始化堆。

### 1.1.4. 初始化硬件
一些嵌入式系统可能需要在主程序运行之前进行特定的硬件初始化，如配置时钟、初始化内存控制器、设置GPIO模式等。

### 1.1.5. 跳转到主程序
最后，启动文件将控制权转交给主程序，通常是C语言的 `main()` 函数。

### 1.1.6. 附加功能
在一些复杂的系统中，启动文件还可能涉及更多的任务，比如执行一些自检（self-test）、加载操作系统、设置多核CPU环境等。

总体来说，启动文件在嵌入式系统中起到“铺路”的作用，确保硬件和软件环境都准备就绪，以便应用程序能够正确、有效地运行。